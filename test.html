<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test SmartLink</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-check-circle text-success me-2"></i>Test SmartLink</h3>
                    </div>
                    <div class="card-body">
                        <h5>Vérifications automatiques :</h5>
                        <ul class="list-group list-group-flush" id="testResults">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>Chargement des fichiers CSS</span>
                                <span class="badge bg-secondary" id="cssTest">En cours...</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>Chargement des fichiers JavaScript</span>
                                <span class="badge bg-secondary" id="jsTest">En cours...</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>Support localStorage</span>
                                <span class="badge bg-secondary" id="storageTest">En cours...</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>Dépendances CDN</span>
                                <span class="badge bg-secondary" id="cdnTest">En cours...</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>Responsive Design</span>
                                <span class="badge bg-secondary" id="responsiveTest">En cours...</span>
                            </li>
                        </ul>
                        
                        <div class="mt-4">
                            <h5>Actions de test :</h5>
                            <div class="d-grid gap-2">
                                <button class="btn btn-primary" onclick="testLocalStorage()">
                                    <i class="fas fa-database me-2"></i>Tester localStorage
                                </button>
                                <button class="btn btn-success" onclick="loadDemoData()">
                                    <i class="fas fa-upload me-2"></i>Charger données de démo
                                </button>
                                <button class="btn btn-info" onclick="testThemes()">
                                    <i class="fas fa-palette me-2"></i>Tester les thèmes
                                </button>
                                <a href="profile.html" class="btn btn-warning">
                                    <i class="fas fa-user me-2"></i>Aller au profil
                                </a>
                                <a href="index.html" class="btn btn-secondary">
                                    <i class="fas fa-home me-2"></i>Page d'accueil
                                </a>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <h5>Informations système :</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <small class="text-muted">
                                        <strong>Navigateur :</strong> <span id="browserInfo"></span><br>
                                        <strong>Résolution :</strong> <span id="screenInfo"></span><br>
                                        <strong>Support tactile :</strong> <span id="touchInfo"></span>
                                    </small>
                                </div>
                                <div class="col-md-6">
                                    <small class="text-muted">
                                        <strong>localStorage :</strong> <span id="storageInfo"></span><br>
                                        <strong>JavaScript :</strong> <span id="jsInfo">Activé</span><br>
                                        <strong>Cookies :</strong> <span id="cookieInfo"></span>
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Tests automatiques au chargement
        document.addEventListener('DOMContentLoaded', function() {
            runAllTests();
            displaySystemInfo();
        });

        function runAllTests() {
            // Test CSS
            const cssTest = document.getElementById('cssTest');
            try {
                const styles = getComputedStyle(document.body);
                cssTest.textContent = 'OK';
                cssTest.className = 'badge bg-success';
            } catch (e) {
                cssTest.textContent = 'Erreur';
                cssTest.className = 'badge bg-danger';
            }

            // Test JavaScript
            const jsTest = document.getElementById('jsTest');
            jsTest.textContent = 'OK';
            jsTest.className = 'badge bg-success';

            // Test localStorage
            const storageTest = document.getElementById('storageTest');
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                storageTest.textContent = 'OK';
                storageTest.className = 'badge bg-success';
            } catch (e) {
                storageTest.textContent = 'Non supporté';
                storageTest.className = 'badge bg-danger';
            }

            // Test CDN (Bootstrap)
            const cdnTest = document.getElementById('cdnTest');
            if (typeof bootstrap !== 'undefined') {
                cdnTest.textContent = 'OK';
                cdnTest.className = 'badge bg-success';
            } else {
                cdnTest.textContent = 'Erreur';
                cdnTest.className = 'badge bg-danger';
            }

            // Test Responsive
            const responsiveTest = document.getElementById('responsiveTest');
            const viewport = window.innerWidth;
            if (viewport > 0) {
                responsiveTest.textContent = `OK (${viewport}px)`;
                responsiveTest.className = 'badge bg-success';
            }
        }

        function displaySystemInfo() {
            document.getElementById('browserInfo').textContent = navigator.userAgent.split(' ').slice(-2).join(' ');
            document.getElementById('screenInfo').textContent = `${screen.width}x${screen.height}`;
            document.getElementById('touchInfo').textContent = 'ontouchstart' in window ? 'Oui' : 'Non';
            document.getElementById('storageInfo').textContent = typeof(Storage) !== 'undefined' ? 'Supporté' : 'Non supporté';
            document.getElementById('cookieInfo').textContent = navigator.cookieEnabled ? 'Activés' : 'Désactivés';
        }

        function testLocalStorage() {
            try {
                const testData = {
                    test: true,
                    timestamp: new Date().toISOString(),
                    random: Math.random()
                };
                localStorage.setItem('smartlink_test', JSON.stringify(testData));
                const retrieved = JSON.parse(localStorage.getItem('smartlink_test'));
                
                if (retrieved && retrieved.test === true) {
                    alert('✅ localStorage fonctionne parfaitement !');
                    localStorage.removeItem('smartlink_test');
                } else {
                    alert('❌ Erreur lors de la récupération des données');
                }
            } catch (error) {
                alert('❌ Erreur localStorage: ' + error.message);
            }
        }

        function loadDemoData() {
            if (confirm('Charger les données de démonstration ? Cela remplacera vos données actuelles.')) {
                fetch('demo-data.json')
                    .then(response => response.json())
                    .then(data => {
                        localStorage.setItem('smartlink_data', JSON.stringify(data.profile));
                        localStorage.setItem('smartlink_stats', JSON.stringify(data.stats));
                        alert('✅ Données de démo chargées ! Allez sur profile.html pour voir le résultat.');
                    })
                    .catch(error => {
                        alert('❌ Erreur lors du chargement: ' + error.message);
                    });
            }
        }

        function testThemes() {
            const themes = ['light', 'dark'];
            let currentTheme = 0;
            
            const interval = setInterval(() => {
                document.documentElement.setAttribute('data-theme', themes[currentTheme]);
                currentTheme = (currentTheme + 1) % themes.length;
                
                if (currentTheme === 0) {
                    clearInterval(interval);
                    alert('✅ Test des thèmes terminé !');
                }
            }, 1000);
        }
    </script>
</body>
</html>
